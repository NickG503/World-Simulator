action: turn_on
object_type: flashlight
version: 1

parameters:
  # No parameters needed - just turn the flashlight on

preconditions:
  # Can only turn on if switch is currently off
  - type: attribute_check
    target: switch.position
    operator: equals
    value: off
    
  # Must have battery power to turn on (constraint enforcement)
  - type: attribute_check
    target: battery.level
    operator: not_equals
    value: empty

effects:
  # Turn on the switch
  - type: set_attribute
    target: switch.position
    value: "on"
    
  # Turn on the bulb (flashlight-specific behavior)
  - type: set_attribute
    target: bulb.state
    value: "on"
    
  # Set appropriate brightness based on battery level
  - type: conditional
    condition:
      type: attribute_check
      target: battery.level
      operator: equals
      value: high
    then:
      - type: set_attribute
        target: bulb.brightness
        value: high
    else:
      - type: conditional
        condition:
          type: attribute_check
          target: battery.level
          operator: equals
          value: medium
        then:
          - type: set_attribute
            target: bulb.brightness
            value: medium
        else:
          - type: set_attribute
            target: bulb.brightness
            value: low
  
  # Battery starts draining when flashlight is on
  - type: set_trend
    target: battery.level
    direction: down
