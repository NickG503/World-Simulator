type: tv
parts:
  button:
    attributes:
      state:
        space: binary_state
        default: 'on'
        mutable: true
  screen:
    attributes:
      power:
        space: binary_state
        default: 'off'
        mutable: true
      brightness:
        space: brightness_level
        default: none
  audio:
    attributes:
      volume:
        space: volume_level
        default: medium
        mutable: true
      channel:
        space: channel_number
        default: unknown  # This will trigger clarification!
        mutable: true
  network:
    attributes:
      wifi_connected:
        space: binary_state
        default: 'unknown'
        mutable: true
  power_source:
    attributes:
      connection:
        space: binary_state
        default: unknown
        mutable: true
      voltage:
        space: power_level
        default: unknown  # This will trigger clarification!
        mutable: true
  cooling:
    attributes:
      temperature:
        space: temperature_level
        default: unknown
        mutable: true

constraints:
- type: dependency
  condition:
    type: attribute_check
    target: screen.power
    operator: equals
    value: on
  requires:
    type: attribute_check
    target: power_source.connection
    operator: not_equals
    value: off
- type: dependency
  condition:
    type: attribute_check
    target: cooling.temperature
    operator: equals
    value: hot
  requires:
    type: attribute_check
    target: screen.power
    operator: equals
    value: off

behaviors:
  turn_on:
    effects:
      - type: set_attribute
        target: button.state
        value: "on"
      - type: set_attribute
        target: screen.power
        value: "on"
      - type: set_attribute
        target: screen.brightness
        value: medium
      - type: set_trend
        target: cooling.temperature
        direction: up

  overheat:
    preconditions:
      - type: attribute_check
        target: screen.power
        operator: equals
        value: on
      - type: attribute_check
        target: cooling.temperature
        operator: equals
        value: hot  # This will violate constraint!
    effects:
      - type: set_attribute
        target: cooling.temperature
        value: hot
      - type: set_attribute
        target: screen.brightness
        value: none  # Screen dims due to overheating

  turn_off:
    effects:
      - type: set_attribute
        target: button.state
        value: off
      - type: set_attribute
        target: screen.power
        value: off
      - type: set_attribute
        target: screen.brightness
        value: none
      - type: set_trend
        target: cooling.temperature
        direction: down
